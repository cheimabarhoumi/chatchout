<!DOCTYPE html>
<html>
<head>
    <title>Debug Auth</title>
</head>
<body>
    <h1>Debug Authentication</h1>
    <div id="output"></div>
    
    <script>
        function log(message) {
            document.getElementById('output').innerHTML += '<p>' + message + '</p>';
            console.log(message);
        }
        
        // Check localStorage
        const token = localStorage.getItem('token');
        const user = localStorage.getItem('user');
        
        log('Token in localStorage: ' + (token ? 'YES (length: ' + token.length + ')' : 'NO'));
        log('User in localStorage: ' + (user ? 'YES' : 'NO'));
        
        if (token) {
            log('Token preview: ' + token.substring(0, 50) + '...');
        }
        
        if (user) {
            try {
                const userData = JSON.parse(user);
                log('User data: ' + JSON.stringify(userData, null, 2));
            } catch (e) {
                log('Error parsing user data: ' + e.message);
            }
        }
        
        // Test API call
        if (token) {
            log('Testing API call with token...');
            fetch('http://localhost:5000/api/auth/me', {
                headers: {
                    'Authorization': 'Bearer ' + token,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                log('Auth test response status: ' + response.status);
                return response.json();
            })
            .then(data => {
                log('Auth test response: ' + JSON.stringify(data, null, 2));
            })
            .catch(error => {
                log('Auth test error: ' + error.message);
            });
        }
    </script>
</body>
</html>
